"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[508],{6508:function(e,t,n){n.d(t,{b:function(){return U}});var r=n(4776),l=n.n(r),o=n(2322),i=n(5026),a=n(3610),c=n(7763),u=n(2784),s=n(4424);function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){f(e,t,n[t])}))}return e}function m(e,t){return d({},e,f({},t.name,t.value))}var b={searchValue:"",multiple:!1,files:[],isUploading:!1,isLoading:!0,selectedFiles:[],updateValue:function(){}},p=(0,u.createContext)(b),v=function(){return(0,u.useContext)(p)},y=n(6454),h=n(6277),g=function(){return{itemsWrap:(0,h.Z)("grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-7 items-start min-h-[200px] py-6"),itemRoot:(0,h.Z)("relative block group"),itemSquare:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(0,h.Z)("aspect-square w-full rounded-lg bg-white shadow-md overflow-hidden relative",e?"group-hover:shadow-lg duration-200":"cursor-default")},itemLabel:(0,h.Z)("mt-2 overflow-hidden text-ellipsis font-semibold group-hover:underline")}},j=g(),x=function(e){var t=e.id,n=e.filename,r=v(),l=(r.multiple,r.selectedFiles),i=r.updateValue,c=n.split(".").at(-1)||"unknown",s=c.includes("png")||c.includes("jpg")||c.includes("gif"),f=(0,u.useCallback)((function(){i({name:"selectedFiles",value:t})}),[t,i]),d=(0,u.useMemo)((function(){return l.includes(t)}),[l,t]);return(0,o.jsxs)("button",{className:(0,h.Z)(j.itemRoot,"group"),onClick:f,type:"button",children:[(0,o.jsx)("div",{className:j.itemSquare(),children:s?(0,o.jsx)("img",{alt:"uploaded file",className:"absolute top-0 left-0 h-full w-full object-cover",src:"/api/entry-types/files/items/".concat(t)}):(0,o.jsx)("div",{className:"flex h-full w-full",children:(0,o.jsx)("p",{className:"m-auto text-3xl font-bold text-gray-400",children:c})})}),(0,o.jsx)("h1",{className:j.itemLabel,children:n}),(0,o.jsx)("div",{className:"absolute top-0 right-0 m-2.5",children:(0,o.jsx)("div",{className:(0,h.Z)("flex h-10 w-10 rounded-lg border-2 border-project-border bg-white shadow-lg transition-all duration-150",d?"text-green-600":"text-white group-hover:text-blue-200"),children:(0,o.jsx)(a.R.CheckIcon,{className:(0,h.Z)("m-auto h-8 w-8",d?"scale-100":"scale-80 ")})})})]})},w=function(){var e=g();return(0,o.jsx)("div",{className:e.itemSquare(!1)})};function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var N=function(e){var t=e.onDeleteClick,n=g(),r=v(),l=r.files,i=r.isLoading;return(0,o.jsx)("div",{className:n.itemsWrap,children:i?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(w,{}),(0,o.jsx)(w,{}),(0,o.jsx)(w,{}),(0,o.jsx)(w,{}),(0,o.jsx)(w,{}),(0,o.jsx)(w,{})]}):l.length?l.map((function(e){return(0,o.jsx)(x,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){O(e,t,n[t])}))}return e}({onDeleteClick:t},e),e.id)})):(0,o.jsx)(y.Z,{className:"col-span-1 sm:col-span-2 md:col-span-4"})})},k=n(1804),P=n(5482);function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e,t){if(null==e)return{};var n,r,l=function(e,t){if(null==e)return{};var n,r,l={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var E=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return k.x.get(e,{params:t}).then((function(e){return e.data}))};function I(e){var t=(0,P.ZP)([c.Uq.getListUrl("files")+"/paged-items",e],E),n=t.data,r=t.error;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){S(e,t,n[t])}))}return e}({data:n,isLoading:!r&&!n,isError:r},C(t,["data","error"]))}var A=n(2861),Z=n(2829),L=function(e){var t=e.onAddButtonClick,n=(0,Z.$)().t;return(0,o.jsxs)("div",{className:"flex w-full items-center",children:[(0,o.jsx)("div",{className:"mr-5 flex-1",children:(0,o.jsx)(A.Z,{name:"query",className:"w-full",placeholder:n("Your filename, id, description...")})}),(0,o.jsx)(i.z,{color:"success",className:"flex-none",onClick:t,children:(0,o.jsx)(a.R.PlusIcon,{className:"!-mx-2 aspect-square w-8"})})]})};function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function q(e,t,n,r,l,o,i){try{var a=e[o](i),c=a.value}catch(u){return void n(u)}a.done?t(c):Promise.resolve(c).then(r,l)}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,l,o=[],i=!0,a=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(c){a=!0,l=c}finally{try{i||null==n.return||n.return()}finally{if(a)throw l}}return o}}(e,t)||_(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){if(e){if("string"===typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(e,t):void 0}}var U=function(e){var t=e.multiple,n=e.triggerClose,r=e.pickedFiles,f=e.onChange,v=F(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,u.useReducer)(m,d({},b,e))}(),2),y=v[0],h=v[1],g=(0,u.useState)(1),j=g[0],x=g[1],w=I({page:j}),O=w.data,k=w.isError,P=w.isLoading,S=w.mutate,C=function(e){return function(){x("next"===e?j+1:j-1)}},E=(0,u.useCallback)((function(e){}),[]),A=(0,u.useCallback)(function(){var e,t=(e=l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h({name:"isLoading",value:!0}),e.next=3,c.Ip.create(t[0],{root:"/"});case 3:h({name:"isLoading",value:!1}),S();case 5:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,l){var o=e.apply(t,n);function i(e){q(o,r,l,i,a,"next",e)}function a(e){q(o,r,l,i,a,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),[h,S]),Z=(0,s.uI)({onDrop:A,noClick:!0,noKeyboard:!0,multiple:!1}).open,D=(0,u.useCallback)((function(e){var l=e.name,o=e.value;if("selectedFiles"===l){var i=r.includes(o)?r.filter((function(e){return e!==o})):z(r).concat([o]);return f(i),void(!t&&n&&n())}h({name:l,value:o})}),[h,f,n,t,r]),_=(0,u.useMemo)((function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){R(e,t,n[t])}))}return e}({},y,{multiple:!!t,files:(null===O||void 0===O?void 0:O.data)||[],isLoading:P||k,selectedFiles:r,updateValue:D})}),[y,O,P,k,D,t,r]);return(0,o.jsx)(p.Provider,{value:_,children:(0,o.jsxs)("div",{className:"p-5",children:[(0,o.jsx)("h1",{className:"mb-5 text-3xl font-semibold",children:t?"Select files":"Select a file"}),(0,o.jsx)(L,{onAddButtonClick:Z}),(0,o.jsx)("hr",{className:"mt-8 mb-2 h-0.5 w-full border-none bg-gray-200"}),(0,o.jsx)(N,{onDeleteClick:E}),(0,o.jsxs)("div",{className:"mt-5 flex items-center justify-between",children:[n&&(0,o.jsx)(i.z,{onClick:n,disabled:!r.length,color:"success",children:"Accept"}),(0,o.jsxs)("div",{className:"ml-auto flex items-center",children:[(0,o.jsx)(i.z,{disabled:1===j||P,onClick:C("prev"),className:"",children:(0,o.jsx)(a.R.ChevronLeftIcon,{className:"h-6 w-6"})}),(0,o.jsx)("div",{className:"flex items-center justify-center rounded-lg bg-gray-100 py-2 px-4 font-semibold",children:j}),(0,o.jsx)(i.z,{disabled:(null===O||void 0===O?void 0:O.last_page)===j||P,onClick:C("next"),children:(0,o.jsx)(a.R.ChevronRightIcon,{className:"h-6 w-6"})})]})]})]})})}},6454:function(e,t,n){var r=n(2322),l=n(7962),o=n(6277),i=n(2829);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){if(null==e)return{};var n,r,l=function(e,t){if(null==e)return{};var n,r,l={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}t.Z=function(e){var t=e.className,n=c(e,["className"]),u=(0,i.$)().t;return(0,r.jsxs)("div",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){a(e,t,n[t])}))}return e}({className:(0,o.Z)("flex min-h-[300px] flex-col justify-center text-center text-xl font-semibold text-gray-400",t)},n,{children:[(0,r.jsx)(l.zqj,{className:"mx-auto w-10"}),(0,r.jsx)("p",{children:u("No items available...")})]}))}}}]);