(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[577],{99962:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/user-roles",function(){return r(1231)}])},1231:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return B}});var t=r(52322),s=r(94776),o=r.n(s),i=r(96454),a=r(8168),l=r(25865),c=r(97470),u=r(10107),d=r(70790),f=r(59935),m=r(24917),p=r(74559),h=r(85409),x=r(11794),b=r(53610),v=r(41277),j=r(6277),g=r(2784),y=r(52829),w=r(63955),k=r(85393),C=r(23384),N=r(58532),O=r(34272),S=r(40530),P=r(57897),_=r(45521),A=r(9687),E=r(93256),D=r(86184),I=[{label:"Create",isSimple:!0,key:(0,D.k)()},{label:"Read",key:(0,D.k)()},{label:"Update",key:(0,D.k)()},{label:"Delete",key:(0,D.k)()}],U=function(e){var n=e.modelInfo,r=e.modelName,s=(0,y.$)().t,o=I.map((function(e){var n,o=e.label,i=e.key,a=e.isSimple;return(0,t.jsx)(w.Qr,{name:"permissions.models.".concat(r,".").concat(null===(n=o.at(0))||void 0===n?void 0:n.toLowerCase()),render:function(e){var n=e.field,r=n.value,i=n.onChange;return(0,t.jsxs)("div",{className:"mt-5",children:[(0,t.jsx)(P.X,{mt:"xs",className:"cursor-pointer",label:o,checked:!!r,onChange:function(){return i(!r&&"allow-everything")}}),!a&&(0,t.jsx)(_.U,{in:!!r,children:(0,t.jsxs)(A.E,{required:!0,spacing:"xs",value:r,ml:33,orientation:"vertical",size:"sm",onChange:i,children:[(0,t.jsx)(E.Y,{disabled:!r,value:"allow-everything",label:s("Allow on everything")}),(0,t.jsx)(E.Y,{disabled:!r,value:"allow-own",label:s("Allow on only own and shared")})]})})]})}},i)})),i=b.R[n.icon];return(0,t.jsxs)("div",{children:[(0,t.jsxs)(C.D,{mb:"sm",order:5,className:"text-blue-500",children:[(0,t.jsx)(i,{size:17,className:"mr-2 -mb-0.5"}),s(r)]}),o]})},R=r(76902);function T(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function z(e,n,r,t,s,o,i){try{var a=e[o](i),l=a.value}catch(c){return void r(c)}a.done?n(l):Promise.resolve(l).then(t,s)}function M(e){return function(){var n=this,r=arguments;return new Promise((function(t,s){var o=e.apply(n,r);function i(e){z(o,t,s,i,a,"next",e)}function a(e){z(o,t,s,i,a,"throw",e)}i(void 0)}))}}function $(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function Z(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){$(e,n,r[n])}))}return e}function F(e,n){if(null==e)return{};var r,t,s=function(e,n){if(null==e)return{};var r,t,s={},o=Object.keys(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||(s[r]=e[r]);return s}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function X(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var t,s,o=[],i=!0,a=!1;try{for(r=r.call(e);!(i=(t=r.next()).done)&&(o.push(t.value),!n||o.length!==n);i=!0);}catch(l){a=!0,s=l}finally{try{i||null==r.return||r.return()}finally{if(a)throw s}}return o}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return T(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var W=function(e){var n=e.opened,r=e.onClose,s=e.optionToEdit,i=(0,w.cI)(),l=(0,y.$)().t,u=(0,R.c)("userroles",s).data,d=(0,c.$)(),f=(0,a.bN)().models,p=i.handleSubmit,h=i.formState,x=i.register,b=i.reset;(0,g.useEffect)((function(){s?u&&b(u):b({})}),[u,b,s,n]);var j=function(){var e=M(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{d({title:l(s?"Updating user role":"Creating user role"),message:l("Please wait..."),successMessage:l(s?"User role successfully updated":"User role has been created")},M(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=6;break}return n.id,t=F(n,["id"]),e.next=4,v._c.update(s,t);case 4:e.next=8;break;case 6:return e.next=8,v._c.create(n);case 8:r();case 9:case"end":return e.stop()}}),e)}))))}catch(t){}case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),P=(0,g.useMemo)((function(){if(f)return Object.entries(f).filter((function(e){var n=X(e,1)[0];return!["userRoles","users","settings"].includes(n)}))}),[f]);return(0,t.jsx)(w.RV,Z({},i,{children:(0,t.jsx)(k.d,{opened:n,onClose:r,position:"right",padding:32,size:500,className:" overflow-auto",title:(0,t.jsx)(C.D,{order:4,children:s?"Update user role":"Create user role"}),children:(0,t.jsxs)("form",{className:"h-full",onSubmit:p(j),children:[(0,t.jsxs)(N.M,{cols:1,spacing:"md",children:[(0,t.jsx)(O.o,Z({label:"Name"},x("label"))),(0,t.jsx)(S.g,Z({autosize:!0,label:l("Description"),minRows:4},x("description"))),(0,t.jsx)(C.D,{mt:"lg",order:4,children:"Permissions by models"}),(0,t.jsx)(N.M,{cols:1,className:"gap-10",children:P&&P.map((function(e){var n=X(e,2),r=n[0],s=n[1];return(0,t.jsx)(g.Fragment,{children:(0,t.jsx)(U,{modelInfo:s,modelName:r})},r)}))})]}),(0,t.jsx)("div",{className:"sticky right-0 -bottom-8 rounded-lg bg-white pt-5 pb-4",children:(0,t.jsx)(m.z,{className:"mr-auto block",type:"submit",loading:h.isSubmitting,loaderPosition:"right",children:l(s?"Save":"Create")})})]})})}))};function Y(e,n,r,t,s,o,i){try{var a=e[o](i),l=a.value}catch(c){return void r(c)}a.done?n(l):Promise.resolve(l).then(t,s)}function q(e){return function(){var n=this,r=arguments;return new Promise((function(t,s){var o=e.apply(n,r);function i(e){Y(o,t,s,i,a,"next",e)}function a(e){Y(o,t,s,i,a,"throw",e)}i(void 0)}))}}var G=(0,u.k)((function(){return{root:{td:{verticalAlign:"baseline"}}}})),L=(0,t.jsx)(d.r.Col,{span:12,children:(0,t.jsx)(f.i,{})}),Q=function(){var e=G().classes,n=(0,y.$)().t,r=(0,a.bN)().currentUserIsAdmin,s=(0,g.useState)(1),u=s[0],w=s[1],k=(0,l.y)("userroles",{page:u}),C=k.data,N=k.mutate,O=(0,g.useState)(),S=O[0],P=O[1],_=(0,g.useState)(!1),A=_[0],E=_[1],D=(0,c.$)(),I=r,U=r,R=(0,g.useCallback)((function(e){return function(){P(e)}}),[]),T=(0,g.useCallback)((function(e){return q(o().mark((function r(){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:try{D({title:"Deleting",message:n("Deleting selected user role, please wait..."),successMessage:n("User role deleted!")},q(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,v._c.delete(e);case 2:return n.next=4,N();case 4:case"end":return n.stop()}}),n)}))))}catch(t){}case 1:case"end":return r.stop()}}),r)})))}),[n,D,N]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:r&&(0,t.jsx)(m.z,{color:"green",mt:"lg",leftIcon:(0,t.jsx)(b.R.Plus,{}),onClick:function(){return E(!0)},children:n("Add new")})}),(0,t.jsxs)(d.r,{sx:{minWidth:800},className:(0,j.Z)(e.root,"mt-5 min-h-[400px]"),columns:12,children:[(0,t.jsx)(d.r.Col,{span:2,className:"font-semibold uppercase",children:n("Title")}),(0,t.jsx)(d.r.Col,{span:8,className:"font-semibold uppercase",children:n("Description")}),(0,t.jsx)(d.r.Col,{span:2,children:(0,t.jsx)("span",{className:"hidden",children:n("Tools")})}),(0,t.jsx)(d.r.Col,{span:12,children:(0,t.jsx)(f.i,{size:"sm"})}),(null===C||void 0===C?void 0:C.data)?C.data.map((function(e,n){return(0,t.jsxs)(g.Fragment,{children:[0!==n&&L,(0,t.jsx)(d.r.Col,{span:2,children:e.label}),(0,t.jsx)(d.r.Col,{span:8,children:e.description}),(0,t.jsx)(d.r.Col,{span:2,children:0!==e.id&&(0,t.jsxs)(p.Z,{className:"ml-auto",position:"right",spacing:"xs",noWrap:!0,children:[I&&(0,t.jsx)(h.A,{onClick:R(e.id),color:"blue",children:(0,t.jsx)(b.R.Edit,{})}),U&&(0,t.jsx)(h.A,{onClick:T(e.id),color:"red",children:(0,t.jsx)(b.R.Trash,{})})]})})]},e.id)})):(0,t.jsx)(d.r.Col,{span:12,children:(0,t.jsx)(i.Z,{})})]}),C&&(0,t.jsx)(p.Z,{position:"center",my:"xl",children:(0,t.jsx)(x.t,{className:"my-auto",page:u,onChange:w,total:C.last_page})}),(0,t.jsx)(W,{opened:A||!!S,optionToEdit:S,onClose:function(){N(),P(void 0),E(!1)}})]})},V=r(57704),B=function(){return(0,t.jsx)(V.Gv,{children:(0,t.jsx)(Q,{})})}}},function(e){e.O(0,[568,706,484,673,117,589,774,888,179],(function(){return n=99962,e(e.s=n);var n}));var n=e.O();_N_E=n}]);