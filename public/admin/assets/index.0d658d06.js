import{r as f,d as j,E as A,ax as R,a2 as L,b as W,l as k,ak as q,ac as T,ad as _,ay as V,j as u,B as z,h as x,C as B,W as U,m as F,am as G}from"./index.edffba3d.js";import{T as Q}from"./TableView.16ce217a.js";var Y=Object.defineProperty,H=Object.defineProperties,J=Object.getOwnPropertyDescriptors,M=Object.getOwnPropertySymbols,K=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable,N=(i,n,s)=>n in i?Y(i,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[n]=s,Z=(i,n)=>{for(var s in n||(n={}))K.call(n,s)&&N(i,s,n[s]);if(M)for(var s of M(n))X.call(n,s)&&N(i,s,n[s]);return i},$=(i,n)=>H(i,J(n));function ee(i=[]){const[n,s]=f.exports.useState(i);return[n,{setState:s,append:(...t)=>s(a=>[...a,...t]),prepend:(...t)=>s(a=>[...t,...a]),insert:(t,...a)=>s(c=>[...c.slice(0,t),...a,...c.slice(t)]),pop:()=>s(t=>{const a=[...t];return a.pop(),a}),shift:()=>s(t=>{const a=[...t];return a.shift(),a}),apply:t=>s(a=>a.map((c,r)=>t(c,r))),applyWhere:(t,a)=>s(c=>c.map((r,p)=>t(r,p)?a(r,p):r)),remove:(...t)=>s(a=>a.filter((c,r)=>!t.includes(r))),reorder:({from:t,to:a})=>s(c=>{const r=[...c],p=c[t];return r.splice(t,1),r.splice(a,0,p),r}),setItem:(t,a)=>s(c=>{const r=[...c];return r[t]=a,r}),setItemProp:(t,a,c)=>s(r=>{const p=[...r];return p[t]=$(Z({},p[t]),{[a]:c}),p}),filter:t=>{s(a=>a.filter(t))}}]}const ae=({})=>{const i=j(),{modelId:n}=A(),[s,P]=f.exports.useState(1),e=R(),l=L(),[E,y]=f.exports.useState(!1),{data:o,isLoading:w,isError:I,mutate:O}=W(e==null?void 0:e.name,{page:s}),{t:g}=k(),[h,v]=ee(o==null?void 0:o.data);f.exports.useEffect(()=>{o!=null&&o.data&&v.setState(o==null?void 0:o.data)},[o]);const t=f.exports.useMemo(()=>{if(!o)return!1;const{data:d,...m}=o;return m},[o]),a=async({source:d,destination:m})=>{if((m==null?void 0:m.index)===void 0)return;y(!0);const b=h[d.index].id,S=h[m.index].id;b!==S&&(v.reorder({from:d.index,to:m.index}),await _.reorder(e.name,{fromId:b,toId:S})),y(!1)},c=f.exports.useMemo(()=>{if(!!e)return q(e)},[e]),r=e&&(l==null?void 0:l.can({action:"delete",targetModel:e==null?void 0:e.name}))?async d=>{confirm(g(T.ON_DELETE_REQUEST_PROMPT))&&(await _.delete({id:d,model:e==null?void 0:e.name}),O())}:void 0,p=e&&(l==null?void 0:l.can({action:"create",targetModel:e==null?void 0:e.name}))?async d=>{confirm(g(T.ENTRY_ITEM_DUPLICATE))&&i(_.getDuplicateUrl(d,e==null?void 0:e.name))}:void 0,C=()=>i(_.getCreateUrl(e==null?void 0:e.name)),D=d=>i(_.getUrl(d,e==null?void 0:e.name));return f.exports.useEffect(()=>P(1),[n]),!e||!c||V(e.name)?u(z,{text:g("This model with this id does not exist.")}):x(B,{children:[x("div",{className:"flex w-full flex-col justify-between gap-5 py-10 md:flex-row",children:[u("h1",{className:"text-3xl font-semibold capitalize",children:g(e.name)}),u("div",{className:"flex items-center gap-5",children:(l==null?void 0:l.can({action:"create",targetModel:e.name}))&&x(U,{color:"green",className:" items-center font-semibold uppercase",size:"md",onClick:C,children:[u("span",{className:"hidden md:block",children:g("Add new entry")}),u(F,{className:"inline-block h-5 w-5 md:ml-3"})," "]})})]}),u(Q,{isLoading:w||I,items:h,columns:c,metadata:t||void 0,onEditAction:D,onDeleteAction:r,onDuplicateAction:p,ordering:e.hasOrdering,onDragEnd:a,disabled:E,pagination:u(G,{total:(o==null?void 0:o.last_page)||1,page:s,onChange:P})})]})};export{ae as default};
